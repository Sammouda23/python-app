pipeline{

 agent any
   
 environment {
       DOCKERHUB_CREDENTIALS= credentials('dockerhub_id')
                }     
 stages {

    stage('gitclone'){
        steps {
            git 'https://github.com/Sammouda23/python-app.git'
              }
        }
    stage('Buildssss'){
        steps{
            sh 'docker build -t 230589/mypythonapp:latest  . '
        } }   

    stage('Deploy Docker Image') {
        steps {
            script {
                 withCredentials([string(credentialsId: 'dockerhub_id-pwd', variable: 'dockerhub_id')]) {
                    sh 'docker login -u devopshint -p ${dockerhub_id}'
                 }  
                 sh 'docker push -f 230589/mypythonapp:latest'
                }
           }
        }






    stage('Login'){
        steps{
            sh 'ech $DOCKERHUB_CREDENTIALS_PSW  |  docker Login -u $DOCKERHUB_CREDENTIALS_USR  --password-stdin'
        }   }

    stage('Build'){
        steps{
            sh 'docker push  230589/mypythonapp:latest '
        }      

    }
    }
}
